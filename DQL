-- DQL -- 
SELECT  v.venta_id, c.sede AS concesionaria, v.fecha, v.metodo_pago, v.precio_venta, v.vin
FROM    ventas v
JOIN    concesionarias c ON c.concesionaria_id = v.concesionaria_id
WHERE   v.concesionaria_id = 3  <- cámbialo a la sede que te pidan
ORDER BY v.fecha DESC
LIMIT 10;                          

SELECT  v.venta_id, c.sede AS concesionaria, v.fecha, v.metodo_pago, v.precio_venta, v.vin
FROM    ventas v
JOIN    concesionarias c ON c.concesionaria_id = v.concesionaria_id
WHERE   v.concesionaria_id = 3
  AND   v.precio_venta > 150000
ORDER BY v.precio_venta DESC, v.fecha DESC
LIMIT 10;

DROP TABLE IF EXISTS concesionarias_nacional;
CREATE TABLE concesionarias_nacional AS
SELECT
  concesionaria_id,
  -- agregamos sufijo y pasamos por REPLACE para evitar dobles guiones si ya existía el sufijo
  REPLACE(CONCAT(sede, '-Nacional'), '--', '-') AS sede,
  domicilio,
  telefono
FROM concesionarias;
-- Verifica el resultado:
SELECT * FROM concesionarias_nacional ORDER BY concesionaria_id;

-- NO EJECUTAR: Borrado de la tabla auxiliar del punto 3
-- DROP TABLE concesionarias_nacional;

SELECT * FROM inventario;
SELECT * FROM caracteristicas;
SELECT * FROM concesionarias;
SELECT * FROM empleados;
SELECT * FROM servicios_oficiales;
SELECT * FROM aditamentos;
SELECT * FROM venta_aditamentos;
SELECT * FROM ventas;
SELECT * FROM ventas_acumuladas;
